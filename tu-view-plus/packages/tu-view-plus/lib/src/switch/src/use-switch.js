"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const l=require("vue"),m=require("@vue/shared"),s=require("@tu-view-plus/utils");require("../../form/index.js");const d=require("@tu-view-plus/constants"),f=require("../../form/src/hooks/use-form-props.js"),E=require("../../form/src/hooks/use-form-item.js");function w(o,n,i){const b=f.useFormSize(),h=f.useFormDisabled(),{formItem:u}=E.useFormItem(),{inputId:g}=E.useFormItemInputId(o,{formItemContext:u}),c=l.computed(()=>o.modelValue===o.activeValue),P=()=>{const{beforeChange:e}=o;if(h.value)return;if(!e){r();return}const t=e();[m.isPromise(t),s.isBoolean(t)].includes(!0)||s.throwError("TuSwitch","beforeChange must return type `Promise<boolean>` or `boolean`"),m.isPromise(t)?t.then(a=>{a&&r()}).catch(a=>{s.debugWarn("TuSwitch",`some error occurred: ${a}`)}):t&&r()},r=()=>{const e=c.value?o.inactiveValue:o.activeValue;n(d.UPDATE_MODEL_EVENT,e),n(d.CHANGE_EVENT,e),n(d.INPUT_EVENT,e),l.nextTick(()=>i.value.checked=c.value)},T=()=>{var e,t;(t=(e=i.value)==null?void 0:e.focus)==null||t.call(e)};return l.watch(c,e=>{var t;i.value.checked=e,o.validateEvent&&((t=u==null?void 0:u.validate)==null||t.call(u,"change").catch(v=>s.debugWarn(v)))}),{inputId:g,switchSize:b,switchDisabled:h,checked:c,focus:T,handleValueSwitch:P,handleChange:r}}exports.default=w;
