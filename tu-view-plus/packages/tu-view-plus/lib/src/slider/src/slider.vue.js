"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),U=require("@tu-view-plus/hooks"),u=require("@tu-view-plus/utils"),S=require("./slider.js");require("../../form/index.js");const V=require("number-precision"),m=require("./utils.js"),X=require("./slider-ticks.vue.js"),Y=require("./slider-dots.vue.js"),$=require("./slider-marks.vue.js"),z=require("./slider-button.vue.js"),G=require("./slider-input.vue.js");require("../style/slider.css");const H=require("../../form/src/hooks/use-form-props.js"),J=t.defineComponent({name:"TuSlider"}),K=t.defineComponent({...J,props:S.sliderProps,emits:S.sliderEmits,setup(N,{emit:v}){const n=N;V.enableBoundaryChecking(!1);const a=U.useNamespace("slider"),g=H.useFormDisabled(),d=t.ref(null),k=t.ref(),c=n.modelValue?n.modelValue:n.defaultValue,l=t.ref(u.isArray(c)?c[0]:0),r=t.ref(u.isArray(c)?c[1]:c),C=t.ref(!1),w=t.computed(()=>({[a.b()]:!0,[a.m(n.direction)]:n.direction,[a.m(n.size)]:n.size})),P=t.computed(()=>({[a.e("track")]:!0,[a.em("track",n.direction)]:n.direction,[a.is("disabled")]:g.value})),i=t.computed(()=>n.range?u.isArray(n.modelValue)?n.modelValue:[l.value,n.modelValue??r.value]:u.isUndefined(n.modelValue)?[l.value,r.value]:u.isArray(n.modelValue)?[n.min??0,n.modelValue[1]]:[n.min??0,n.modelValue]),h=(e,o)=>{if(!k.value)return 0;const{left:s,top:L,width:j,height:M}=k.value,y=n.direction==="horizontal"?j:M,F=y*n.step/(n.max-n.min);let p=n.direction==="horizontal"?e-s:L+M-o;p<0&&(p=0),p>y&&(p=y);const I=Math.round(p/F);return V.plus(n.min,V.times(I,n.step))},T=([e,o])=>(e>o&&([e,o]=[o,e]),n.direction==="vertical"?{bottom:m.getOffsetPercent(e,[n.min,n.max]),top:m.getOffsetPercent(n.max+n.min-o,[n.min,n.max])}:{left:m.getOffsetPercent(e,[n.min,n.max]),right:m.getOffsetPercent(n.max+n.min-o,[n.min,n.max])}),B=t.computed(()=>Object.keys(n.marks||{}).map(e=>{var s;const o=Number(e);return{key:o,content:(s=n.marks)==null?void 0:s[o],isActive:o>=i.value[0]&&o<=i.value[1]}})),b=e=>m.getPositionStyle(m.getOffsetPercent(e,[n.min,n.max]),n.direction),f=()=>{n.range?(v("update:modelValue",[l.value,r.value]),v("change",[l.value,r.value])):(v("update:modelValue",r.value),v("change",r.value))},E=e=>{if(g.value)return;const{clientX:o,clientY:s}=e;d.value&&(k.value=d.value.getBoundingClientRect()),r.value=h(o,s),f()},_=()=>{C.value=!0,d.value&&(k.value=d.value.getBoundingClientRect())},O=(e,o)=>{l.value=h(e,o),f()},q=()=>{C.value=!1},A=(e,o)=>{r.value=h(e,o),f()},R=e=>{e=e??n.min,l.value=e,f()},D=e=>{e=e??n.min,r.value=e,f()};return t.watch(()=>n.modelValue,e=>{u.isArray(e)?(l.value=e[0]??n.min??0,r.value=e[1]??n.min??0):r.value=e??n.min??0}),(e,o)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(t.unref(w))},[t.createElementVNode("div",{ref_key:"trackRef",ref:d,class:t.normalizeClass(t.unref(P)),onClick:E},[t.createElementVNode("div",{class:t.normalizeClass(t.unref(a).e("bar")),style:t.normalizeStyle(T(t.unref(i)))},null,6),e.showTicks?(t.openBlock(),t.createBlock(X.default,{key:0,value:t.unref(i),step:e.step,min:e.min,max:e.max,direction:e.direction},null,8,["value","step","min","max","direction"])):t.createCommentVNode("",!0),e.marks?(t.openBlock(),t.createBlock(Y.default,{key:1,dots:t.unref(B),min:e.min,max:e.max,direction:e.direction},null,8,["dots","min","max","direction"])):t.createCommentVNode("",!0),e.marks?(t.openBlock(),t.createBlock($.default,{key:2,marks:t.unref(B),min:e.min,max:e.max,direction:e.direction},null,8,["marks","min","max","direction"])):t.createCommentVNode("",!0),e.range?(t.openBlock(),t.createBlock(z.default,{key:3,style:t.normalizeStyle(b(t.unref(i)[0])),value:t.unref(i)[0],min:e.min,max:e.max,disabled:t.unref(g),direction:e.direction,"format-tooltip":e.formatTooltip,"show-tooltip":e.showTooltip,onMovestart:_,onMoving:O,onMoveend:q},null,8,["style","value","min","max","disabled","direction","format-tooltip","show-tooltip"])):t.createCommentVNode("",!0),t.createVNode(z.default,{style:t.normalizeStyle(b(t.unref(i)[1])),value:t.unref(i)[1],min:e.min,max:e.max,direction:e.direction,disabled:t.unref(g),"format-tooltip":e.formatTooltip,"show-tooltip":e.showTooltip,onMovestart:_,onMoving:A,onMoveend:q},null,8,["style","value","min","max","direction","disabled","format-tooltip","show-tooltip"])],2),e.showInput?(t.openBlock(),t.createBlock(G.default,{key:0,"model-value":t.unref(i),size:e.size,min:e.min,max:e.max,step:e.step,range:e.range,disabled:e.disabled,onStartChange:R,onEndChange:D},null,8,["model-value","size","min","max","step","range","disabled"])):t.createCommentVNode("",!0)],2))}});exports.default=K;
