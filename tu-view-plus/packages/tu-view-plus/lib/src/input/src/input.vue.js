"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),R=require("./input.js"),d=require("../../icon/index.js"),w=require("@tu-view-plus/hooks"),K=require("@tu-view-plus/utils"),I=require("@tu-view-plus/icons-vue");require("../../form/index.js");const te=require("./use-input.js");require("../style/input.css");const W=require("../../form/src/hooks/use-form-props.js"),j=require("../../form/src/hooks/use-form-item.js"),se=["role"],ue=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],le=e.defineComponent({name:"TuInput",inheritAttrs:!1}),ae=e.defineComponent({...le,props:R.inputProps,emits:R.inputEmits,setup(H,{expose:O,emit:G}){const s=H,C=e.shallowRef(),u=e.useSlots(),t=w.useNamespace("input"),l=w.useNamespace("input-group"),b=W.useFormSize(),a=W.useFormDisabled(),f=w.useComponentAttrs({excludeKeys:e.computed(()=>Object.keys(L.value))}),{form:c,formItem:m}=j.useFormItem(),{inputId:U}=j.useFormItemInputId(s,{formItemContext:m}),{inputRef:J,isHovering:Q,isFocused:v,isPasswordVisible:V,textLength:h,nativeInputValue:y,focus:i,blur:X,select:Y,clear:N,handleMouseEnter:S,handleMouseLeave:g,handleCompositionStart:z,handleCompositionUpdate:E,handleCompositionEnd:x,handleInput:P,handleFocus:q,handleBlur:A,handleChange:F,handleKeydown:M,handlePasswordVisible:Z,setNativeInputValue:_}=te.default(s,G,C),p=e.computed(()=>(m==null?void 0:m.validateState)||""),D=e.computed(()=>(c==null?void 0:c.statusIcon)??!1),T=e.computed(()=>p.value&&K.ValidateComponentsMap[p.value]),ee=e.computed(()=>!!k.value&&h.value>Number(f.value.maxlength)),B=e.computed(()=>s.clearable&&!a.value&&!s.readonly&&!!y.value&&(v.value||Q.value)),$=e.computed(()=>s.showPassword&&!a.value&&!s.readonly&&!!y.value&&(!!y.value||v.value)),k=e.computed(()=>s.showWordLimit&&!!f.value.maxlength&&s.type==="text"&&!a.value&&!s.readonly&&!s.showPassword),ne=e.computed(()=>!!u.suffix||!!s.suffixIcon||B.value||s.showPassword||k.value||!!p.value&&D.value),oe=e.computed(()=>({[t.b()]:!0,[t.m(b.value)]:b.value,[t.is("disabled")]:a.value,[t.is("exceed")]:ee.value,[l.b()]:u.prepend||u.append,[l.m("prepend")]:u.prepend,[l.m("append")]:u.append,[e.useAttrs().class]:e.useAttrs().class})),re=e.computed(()=>[e.useAttrs().style,s.inputStyle]),L=e.computed(()=>{const n={};return s.containerRole==="combobox"&&(n["aria-haspopup"]=e.useAttrs()["aria-haspopup"],n["aria-owns"]=e.useAttrs()["aria-owns"],n["aria-expanded"]=e.useAttrs()["aria-expanded"]),n});return e.onMounted(()=>{!s.formatter&&s.parser&&K.debugWarn("TuInput","If you set the parser, you also need to set the formatter."),_()}),O({input:C,ref:J,focus:i,blur:X,select:Y,clear:N}),(n,o)=>e.withDirectives((e.openBlock(),e.createElementBlock("div",e.mergeProps(e.unref(L),{class:e.unref(oe),style:e.unref(re),role:n.containerRole,onMouseenter:o[11]||(o[11]=(...r)=>e.unref(S)&&e.unref(S)(...r)),onMouseleave:o[12]||(o[12]=(...r)=>e.unref(g)&&e.unref(g)(...r))}),[n.$slots.prepend?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(l).e("prepend"))},[e.renderSlot(n.$slots,"prepend")],2)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass([e.unref(t).e("wrapper"),{[e.unref(t).is("focus")]:e.unref(v)}])},[n.$slots.prefix||n.prefixIcon?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(e.unref(t).e("prefix"))},[e.createElementVNode("span",{class:e.normalizeClass(e.unref(t).e("prefix-inner")),onClick:o[0]||(o[0]=(...r)=>e.unref(i)&&e.unref(i)(...r))},[e.renderSlot(n.$slots,"prefix"),n.prefixIcon?(e.openBlock(),e.createBlock(e.unref(d.TuIcon),{key:0,class:e.normalizeClass(e.unref(t).e("icon"))},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.prefixIcon)))]),_:1},8,["class"])):e.createCommentVNode("",!0)],2)],2)):e.createCommentVNode("",!0),e.createElementVNode("input",e.mergeProps({ref_key:"input",ref:C},e.unref(f),{id:e.unref(U),class:e.unref(t).e("inner"),type:n.showPassword?e.unref(V)?"text":"password":n.type,disabled:e.unref(a),formatter:n.formatter,parser:n.parser,readonly:n.readonly,autocomplete:n.autocomplete,tabindex:n.tabindex,"aria-label":n.label,placeholder:n.placeholder,style:n.inputStyle,form:e.unref(c),onCompositionstart:o[1]||(o[1]=(...r)=>e.unref(z)&&e.unref(z)(...r)),onCompositionupdate:o[2]||(o[2]=(...r)=>e.unref(E)&&e.unref(E)(...r)),onCompositionend:o[3]||(o[3]=(...r)=>e.unref(x)&&e.unref(x)(...r)),onInput:o[4]||(o[4]=(...r)=>e.unref(P)&&e.unref(P)(...r)),onFocus:o[5]||(o[5]=(...r)=>e.unref(q)&&e.unref(q)(...r)),onBlur:o[6]||(o[6]=(...r)=>e.unref(A)&&e.unref(A)(...r)),onChange:o[7]||(o[7]=(...r)=>e.unref(F)&&e.unref(F)(...r)),onKeydown:o[8]||(o[8]=(...r)=>e.unref(M)&&e.unref(M)(...r))}),null,16,ue),e.unref(ne)?(e.openBlock(),e.createElementBlock("span",{key:1,class:e.normalizeClass(e.unref(t).e("suffix"))},[e.createElementVNode("span",{class:e.normalizeClass(e.unref(t).e("suffix-inner")),onClick:o[10]||(o[10]=(...r)=>e.unref(i)&&e.unref(i)(...r))},[!e.unref(B)||!e.unref($)||!e.unref(k)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(n.$slots,"suffix"),n.suffixIcon?(e.openBlock(),e.createBlock(e.unref(d.TuIcon),{key:0,class:e.normalizeClass(e.unref(t).e("icon"))},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.suffixIcon)))]),_:1},8,["class"])):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0),e.unref(B)?(e.openBlock(),e.createBlock(e.unref(d.TuIcon),{key:1,class:e.normalizeClass([e.unref(t).e("icon"),e.unref(t).em("icon","clear")]),onMousedown:o[9]||(o[9]=e.withModifiers(()=>{},["prevent"])),onClick:e.unref(N)},{default:e.withCtx(()=>[e.createVNode(e.unref(I.Close))]),_:1},8,["class","onClick"])):e.createCommentVNode("",!0),e.unref($)?(e.openBlock(),e.createBlock(e.unref(d.TuIcon),{key:2,class:e.normalizeClass([e.unref(t).e("icon"),e.unref(t).em("icon","password")]),onClick:e.unref(Z)},{default:e.withCtx(()=>[e.unref(V)?(e.openBlock(),e.createBlock(e.unref(I.View),{key:0})):(e.openBlock(),e.createBlock(e.unref(I.Hide),{key:1}))]),_:1},8,["class","onClick"])):e.createCommentVNode("",!0),e.unref(k)?(e.openBlock(),e.createElementBlock("span",{key:3,class:e.normalizeClass(e.unref(t).e("count"))},[e.createElementVNode("span",{class:e.normalizeClass(e.unref(t).e("count-inner"))},e.toDisplayString(e.unref(h))+" / "+e.toDisplayString(e.unref(f).maxlength),3)],2)):e.createCommentVNode("",!0),e.unref(p)&&e.unref(T)&&e.unref(D)?(e.openBlock(),e.createBlock(e.unref(d.TuIcon),{key:4,class:e.normalizeClass([e.unref(t).e("icon"),e.unref(t).e("validateIcon"),e.unref(t).is("loading",e.unref(p)==="validating")])},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(T))))]),_:1},8,["class"])):e.createCommentVNode("",!0)],2)],2)):e.createCommentVNode("",!0)],2),n.$slots.append?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(e.unref(l).e("append"))},[e.renderSlot(n.$slots,"append")],2)):e.createCommentVNode("",!0)],16,se)),[[e.vShow,n.type!=="hidden"]])}});exports.default=ae;
