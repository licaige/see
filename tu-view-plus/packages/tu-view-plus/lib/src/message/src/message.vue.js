"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),c=require("@vueuse/core"),M=require("./message.js"),N=require("@tu-view-plus/constants"),S=require("@tu-view-plus/hooks");require("../../config-provider/index.js");const p=require("./instance.js"),L=require("@tu-view-plus/icons-vue"),v=require("../../icon/index.js"),E=require("../../badge/index.js");require("../style/message.css");const O=require("../../config-provider/src/hooks/use-global-config.js"),V=["id"],I=["innerHTML"],$=e.defineComponent({name:"TuMessage"}),_=e.defineComponent({...$,props:M.messageProps,setup(C,{expose:g}){const o=C,{ns:t,zIndex:k}=O.useGlobalComponentSettings("message"),{currentZIndex:y,nextZIndex:B}=k,l=e.ref(),s=e.ref(!1),i=e.ref(0);let r;const h=e.computed(()=>({[t.b()]:!0,[t.m(o.type)]:o.type,[t.is("center")]:o.center,[t.is("closable")]:o.showClose,[o.customClass]:!0})),T=e.computed(()=>p.getLastOffset(o.id)),d=e.computed(()=>p.getOffsetOrSpace(o.id,o.offset)+T.value),q=e.computed(()=>i.value+d.value),b=e.computed(()=>({top:`${d.value}px`,zIndex:y.value})),w=e.computed(()=>o.type?o.type==="error"?"danger":o.type:"info"),a=()=>{s.value=!1},f=()=>{r==null||r()},u=()=>{o.duration!==0&&({stop:r}=c.useTimeoutFn(()=>{a()},o.duration))},z=({code:n})=>{n===N.EVENT_CODE.esc&&a()};return e.onMounted(()=>{u(),B(),s.value=!0}),e.watch(()=>o.repeatNum,()=>{f(),u()}),c.useEventListener(document,"keydown",z),c.useResizeObserver(l,()=>{i.value=l.value.getBoundingClientRect().height}),g({visible:s,bottom:q,close:a}),(n,m)=>(e.openBlock(),e.createBlock(e.Transition,{name:`${e.unref(S.defaultNamespace)}-fade-in-linear`,onBeforeLeave:n.onClose,onAfterLeave:m[0]||(m[0]=D=>n.$emit("destroy"))},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{ref_key:"messageRef",ref:l,role:"alert",id:n.id,class:e.normalizeClass(e.unref(h)),style:e.normalizeStyle(e.unref(b)),onMouseenter:f,onMouseleave:u},[n.repeatNum>1?(e.openBlock(),e.createBlock(e.unref(E.TuBadge),{key:0,value:n.repeatNum,type:e.unref(w),class:e.normalizeClass(e.unref(t).e("badge"))},null,8,["value","type","class"])):e.createCommentVNode("",!0),n.icon?(e.openBlock(),e.createBlock(e.unref(v.TuIcon),{key:1,class:e.normalizeClass([e.unref(t).e("icon")])},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.icon)))]),_:1},8,["class"])):e.createCommentVNode("",!0),e.renderSlot(n.$slots,"default",{},()=>[n.dangerouslyUseHTMLString?(e.openBlock(),e.createElementBlock("span",{key:1,class:e.normalizeClass(e.unref(t).e("content")),innerHTML:n.message},null,10,I)):(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(e.unref(t).e("content"))},e.toDisplayString(n.message),3))]),n.showClose?(e.openBlock(),e.createBlock(e.unref(v.TuIcon),{key:2,class:e.normalizeClass(e.unref(t).em("icon","close")),onClick:e.withModifiers(a,["stop"])},{default:e.withCtx(()=>[e.createVNode(e.unref(L.Close))]),_:1},8,["class","onClick"])):e.createCommentVNode("",!0)],46,V),[[e.vShow,s.value]])]),_:3},8,["name","onBeforeLeave"]))}});exports.default=_;
